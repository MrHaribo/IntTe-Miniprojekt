<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:p="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:rc="http://hsr.ch/rClone"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
</head>
<body>
	<ui:composition template="./template.xhtml">
		<ui:define name="content_header">
			<ui:include src="login.xhtml" />
		</ui:define>
		<ui:define name="content_top" />
		<ui:define name="content_main">
			<h:panelGroup layout="block" id="comments_panelGroup">

				<h:outputText id="test" value="#{linklist.selectedLink.id}"></h:outputText>
				<br />
				<h:outputText id="test2"
					value="Test Entry: ${linklist.selectedLink.title}"></h:outputText>
				<br />
				
				<h:commandButton id="resetSelection" value="Reset selection" action="${commentCreation.resetSelection}" immediate="true">
					<f:ajax execute="@form" render=":comments_panelGroup" />
				</h:commandButton>
				
				<h:panelGroup rendered="#{not commentCreation.isCommentSelected}">
					<rc:commentsubmit voteentry="#{linklist.selectedLink}" render=":comments_panelGroup"/>
				</h:panelGroup>
				
				<p:forEach var="comment" items="#{linklist.selectedLink.children.preorderList}">
	
					<h:form>
						<h:panelGrid border="1" columns="2" style="margin-left:#{comment.margin}px;">
			
							<h:outputText id="title" value="#{comment.text}"></h:outputText>
							<h:outputText value="#{comment.votes}"></h:outputText>
							<h:outputText id="info" value="Created: #{comment.creationDate}" />
							<h:outputText id="numComments" value="Num Comments: #{comment.children.size}" />
							
							<h:commandButton id="select" value="Select" 
								action="${comment.select}" immediate="true">
								<f:ajax execute="@form" render=":comments_panelGroup" />
							</h:commandButton>
			
						</h:panelGrid>
						
						<h:panelGroup rendered="#{comment.selected}">
							<rc:commentsubmit voteentry="#{comment}" render=":comments_panelGroup"/>
						</h:panelGroup>
						
					</h:form>
					<br />
			
				</p:forEach>
				
				<h:form>
					<rc:useless linkid="#{link.id}" hellomsg=	"Das isch de useless component wo i gmacht han!
																i will aber no vom Dozent wüsse wa min Fehler isch, 
																deswege isch es no drin">
						<h:outputText id="test2" value="More useless Child"></h:outputText>
					</rc:useless>
				</h:form>
				
			</h:panelGroup>
		</ui:define>
	</ui:composition>
</body>
</html>